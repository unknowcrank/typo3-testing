.. include:: /Includes.rst.txt

.. _feature-102353-1699523309:

==================================================================
Feature: #102353 - AVIF support for images generated by GIFBUILDER
==================================================================

See :issue:`102353`

Description
===========

GIFBUILDER, the image manipulation library for TypoScript based on GDlib, a PHP
extension bundled into PHP, now also supports generating resulting files of
type "avif".

AVIF is an image format, that is supported by most modern browsers, and usually
has a better compression (= smaller file size) than jpg files.

..  important::

    Before using this feature, please check whether the used operating system
    actually supports de/encoding AVIF files. Especially Debian 11 (Bullseye)
    and older or systems forked from that may lack AVIF support.

Impact
======

If defined via format=avif within a GifBuilder setup, the generated files are
now AVIF files instead of png (the default).

It is possible to define the quality of a AVIF image similar to jpg images
globally via :php:`$TYPO3_CONF_VARS['GFX']['avif_quality']` or via TypoScript's
"quality" property on a per-image basis. Via TypoScript it is also possible
to use the new property "speed" - see https://www.php.net/manual/en/function.imageavif.php
for more details.

Example
-------

.. code-block:: typoscript

    page.10 = IMAGE
    page.10 {
      file = GIFBUILDER
      file {
        backColor = yellow
        XY = 1024,199
        format = avif
        quality = 44
        speed = 1

        10 = IMAGE
        10.offset = 10,10
        10.file = 1:/my-image.jpg
      }
    }

A new test in the Environment module / Install Tool can be used to check if the
bundled GDlib extension of your PHP version supports the AVIF image format.

.. index:: Frontend, TypoScript, ext:frontend
